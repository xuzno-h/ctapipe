

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Exploring Raw Data &mdash; ctapipe v0.6.2.post178+git78208d1</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Explore Calibrated Data" href="calibrated_data_exploration.html" />
    <link rel="prev" title="Getting Started with ctapipe" href="ctapipe_handson.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ctapipe
          

          
          </a>

          
            
            
              <div class="version">
                0.6.2.post178+git78208d1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development Guidelines</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ctapipe_handson.html">Getting Started with ctapipe</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Exploring Raw Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Explore-the-contents-of-an-event">Explore the contents of an event</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Look-for-signal-pixels-in-a-camera">Look for signal pixels in a camera</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Look-at-the-time-trace-from-a-Camera-Pixel">Look at the time trace from a Camera Pixel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Do-a-very-simplisitic-trace-analysis">Do a very simplisitic trace analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Camera-Displays">Camera Displays</a></li>
<li class="toctree-l3"><a class="reference internal" href="#some-signal-processing…">some signal processing…</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="calibrated_data_exploration.html">Explore Calibrated Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="theta_square.html">Make a theta-square plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="lst_analysis_bootcamp_2018.html">2018 LST Bootcamp walkthrough</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ctapipe_api/index.html">API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ctapipe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>Exploring Raw Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/raw_data_exploration.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Exploring-Raw-Data">
<h1>Exploring Raw Data<a class="headerlink" href="#Exploring-Raw-Data" title="Permalink to this headline">¶</a></h1>
<p>Here are just some very simple examples of going through and inspecting the raw data, and making some plots using <code class="docutils literal notranslate"><span class="pre">ctapipe</span></code>. The data explored here are <em>raw Monte Carlo</em> data, which is Data Level “R0” in CTA terminology (e.g. it is before any processing that would happen inside a Camera or off-line)</p>
<p>Setup:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">ctapipe.utils</span> <span class="k">import</span> <span class="n">get_dataset_path</span>
<span class="kn">from</span> <span class="nn">ctapipe.io</span> <span class="k">import</span> <span class="n">event_source</span><span class="p">,</span> <span class="n">EventSeeker</span>
<span class="kn">from</span> <span class="nn">ctapipe.visualization</span> <span class="k">import</span> <span class="n">CameraDisplay</span>
<span class="kn">from</span> <span class="nn">ctapipe.instrument</span> <span class="k">import</span> <span class="n">CameraGeometry</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="k">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<p>To read SimTelArray format data, ctapipe uses the <code class="docutils literal notranslate"><span class="pre">pyeventio</span></code> library (which is installed automatically along with ctapipe). The following lines however will load any data known to ctapipe (multiple <code class="docutils literal notranslate"><span class="pre">EventSources</span></code> are implemented, and chosen automatically based on the type of the input file.</p>
<p>All data access first starts with an <code class="docutils literal notranslate"><span class="pre">EventSource</span></code>, and here we use a helper function <code class="docutils literal notranslate"><span class="pre">event_source</span></code> that constructs one. The resulting <code class="docutils literal notranslate"><span class="pre">source</span></code> object can be iterated over like a list of events. We also here use an <code class="docutils literal notranslate"><span class="pre">EventSeeker</span></code> which provides random-access to the source (by seeking to the given event ID or number)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">source</span> <span class="o">=</span> <span class="n">event_source</span><span class="p">(</span><span class="n">get_dataset_path</span><span class="p">(</span><span class="s2">&quot;gamma_test_large.simtel.gz&quot;</span><span class="p">),</span> <span class="n">max_events</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">seeker</span> <span class="o">=</span> <span class="n">EventSeeker</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Explore-the-contents-of-an-event">
<h2>Explore the contents of an event<a class="headerlink" href="#Explore-the-contents-of-an-event" title="Permalink to this headline">¶</a></h2>
<p>note that the R0 level is the raw data that comes out of a camera, and also the lowest level of monte-carlo data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event</span> <span class="o">=</span> <span class="n">seeker</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># get first event</span>
<span class="n">event</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:ctapipe.io.eventseeker.EventSeeker:Seeking to event by looping through events... (potentially long process)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>ctapipe.io.containers.DataContainer:
                    event_type: Event type
                          r0.*: Raw Data
                          r1.*: R1 Calibrated Data
                         dl0.*: DL0 Data Volume Reduced Data
                         dl1.*: DL1 Calibrated image
                         dl2.*: Reconstructed Shower Information
                          mc.*: Monte-Carlo data
                    mcheader.*: Monte-Carlo run header data
                        trig.*: central trigger information
                         count: number of events processed
                        inst.*: instrumental information (deprecated
                   pointing[*]: Telescope pointing positions
</pre></div>
</div>
</div>
<p>the event is just a class with a bunch of data items in it. You can see a more compact represntation via:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ctapipe.io.containers.R0Container:
                        obs_id: observation ID
                      event_id: event id number
                tels_with_data: list of telescopes with data
                        tel[*]: map of tel_id to R0CameraContainer
</pre></div></div>
</div>
<p>printing the event structure, will currently print the value all items under it (so you get a lot of output if you print a high-level container):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">mc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;alt&#39;: &lt;Angle 1.1591475 rad&gt;,
 &#39;az&#39;: &lt;Angle 6.15383387 rad&gt;,
 &#39;core_x&#39;: &lt;Quantity 123.90383911 m&gt;,
 &#39;core_y&#39;: &lt;Quantity -398.8053894 m&gt;,
 &#39;energy&#39;: &lt;Quantity 0.57071054 TeV&gt;,
 &#39;h_first_int&#39;: &lt;Quantity 24374.49804688 m&gt;,
 &#39;shower_primary_id&#39;: 0,
 &#39;tel&#39;: {13: {&#39;altitude_cor&#39;: 0,
              &#39;altitude_raw&#39;: 1.2217305,
              &#39;azimuth_cor&#39;: 0,
              &#39;azimuth_raw&#39;: 0.0,
              &#39;dc_to_pe&#39;: array([[0.01698951, 0.01661784, 0.01640845, ..., 0.01681372, 0.0169319 ,
        0.01686998]], dtype=float32),
              &#39;pedestal&#39;: array([[2475.8267, 2516.3455, 2538.964 , ..., 2494.8728, 2530.9307,
        2508.394 ]], dtype=float32),
              &#39;photo_electron_image&#39;: array([0., 0., 0., ..., 0., 0., 0.], dtype=float32),
              &#39;reference_pulse_shape&#39;: array([[-4.89234924e-04, -4.89234924e-04, -4.89234924e-04,
        -4.89234924e-04, -4.89234924e-04, -4.89234924e-04,
        -4.89234924e-04, -3.33786011e-04,  2.36868858e-04,
         1.22261047e-03,  2.62260437e-03,  4.44030762e-03,
         6.67190552e-03,  9.31549072e-03,  1.23748779e-02,
         1.58538818e-02,  1.97448730e-02,  2.57568359e-02,
         3.67431641e-02,  5.27038574e-02,  7.36694336e-02,
         9.95483398e-02,  1.30371094e-01,  1.66259766e-01,
         2.07153320e-01,  2.52929688e-01,  3.03710938e-01,
         3.57421875e-01,  4.10644531e-01,  4.63378906e-01,
         5.15136719e-01,  5.66894531e-01,  6.18164062e-01,
         6.68945312e-01,  7.19238281e-01,  7.69042969e-01,
         8.17871094e-01,  8.64257812e-01,  9.03808594e-01,
         9.36523438e-01,  9.62402344e-01,  9.81445312e-01,
         9.94140625e-01,  9.99511719e-01,  9.98046875e-01,
         9.89746094e-01,  9.75097656e-01,  9.55566406e-01,
         9.35058594e-01,  9.14062500e-01,  8.92578125e-01,
         8.69628906e-01,  8.46191406e-01,  8.22265625e-01,
         7.97363281e-01,  7.71484375e-01,  7.45117188e-01,
         7.18261719e-01,  6.92871094e-01,  6.68945312e-01,
         6.45507812e-01,  6.24023438e-01,  6.03515625e-01,
         5.83984375e-01,  5.65429688e-01,  5.48339844e-01,
         5.32714844e-01,  5.17578125e-01,  5.03417969e-01,
         4.89257812e-01,  4.75585938e-01,  4.62402344e-01,
         4.49462891e-01,  4.37255859e-01,  4.25292969e-01,
         4.13818359e-01,  4.02587891e-01,  3.91845703e-01,
         3.81347656e-01,  3.70849609e-01,  3.60839844e-01,
         3.50830078e-01,  3.41064453e-01,  3.31298828e-01,
         3.22021484e-01,  3.12744141e-01,  3.03710938e-01,
         2.94921875e-01,  2.86376953e-01,  2.78076172e-01,
         2.70263672e-01,  2.62695312e-01,  2.55615234e-01,
         2.48657227e-01,  2.42065430e-01,  2.35717773e-01,
         2.29736328e-01,  2.23999023e-01,  2.18261719e-01,
         2.12646484e-01,  2.07153320e-01,  2.01782227e-01,
         1.96411133e-01,  1.91162109e-01,  1.86035156e-01,
         1.80908203e-01,  1.75903320e-01,  1.71020508e-01,
         1.66259766e-01,  1.61621094e-01,  1.56982422e-01,
         1.52587891e-01,  1.48193359e-01,  1.44042969e-01,
         1.39892578e-01,  1.35864258e-01,  1.31958008e-01,
         1.28173828e-01,  1.24511719e-01,  1.21032715e-01,
         1.17675781e-01,  1.14440918e-01,  1.11389160e-01,
         1.08398438e-01,  1.05651855e-01,  1.02966309e-01,
         1.00463867e-01,  9.80224609e-02,  9.56420898e-02,
         9.33227539e-02,  9.09423828e-02,  8.86840820e-02,
         8.64257812e-02,  8.41674805e-02,  8.19702148e-02,
         7.98339844e-02,  7.76977539e-02,  7.55615234e-02,
         7.34863281e-02,  7.14111328e-02,  6.93359375e-02,
         6.73217773e-02,  6.52465820e-02,  6.32324219e-02,
         6.12792969e-02,  5.92956543e-02,  5.73120117e-02,
         5.53894043e-02,  5.36193848e-02,  5.19409180e-02,
         5.03540039e-02,  4.89196777e-02,  4.76074219e-02,
         4.63867188e-02,  4.52880859e-02,  4.43115234e-02,
         4.34570312e-02,  4.26635742e-02,  4.18395996e-02,
         4.10156250e-02,  4.01611328e-02,  3.92761230e-02,
         3.83605957e-02,  3.74145508e-02,  3.64685059e-02,
         3.54919434e-02,  3.44848633e-02,  3.34777832e-02,
         3.24401855e-02,  3.14331055e-02,  3.04107666e-02,
         2.94036865e-02,  2.83813477e-02,  2.73590088e-02,
         2.63366699e-02,  2.53295898e-02,  2.43072510e-02,
         2.33154297e-02,  2.23693848e-02,  2.14843750e-02,
         2.06451416e-02,  1.98669434e-02,  1.91345215e-02,
         1.84783936e-02,  1.78527832e-02,  1.73034668e-02,
         1.67999268e-02,  1.63269043e-02,  1.58386230e-02,
         1.53579712e-02,  1.48620605e-02,  1.43585205e-02,
         1.38397217e-02,  1.33209229e-02,  1.27944946e-02,
         1.22604370e-02,  1.17187500e-02,  1.11770630e-02,
         1.06735229e-02,  1.02005005e-02,  9.75799561e-03,
         9.34600830e-03,  8.96453857e-03,  8.62121582e-03,
         8.30078125e-03,  8.01849365e-03,  7.76290894e-03,
         7.52639771e-03,  7.29370117e-03,  7.05718994e-03,
         6.82067871e-03,  6.58798218e-03,  6.35147095e-03,
         6.11495972e-03,  5.88226318e-03,  5.64575195e-03,
         5.41305542e-03,  5.17272949e-03,  4.91333008e-03,
         4.64248657e-03,  4.35256958e-03,  4.05120850e-03,
         3.73268127e-03,  3.39698792e-03,  3.04603577e-03,
         2.67982483e-03,  2.29835510e-03,  1.91879272e-03,
         1.57070160e-03,  1.25312805e-03,  9.67502594e-04,
         7.12871552e-04,  4.89711761e-04,  2.98023224e-04,
         1.37329102e-04,  8.16583633e-06, -8.97049904e-05,
        -1.59263611e-04, -2.05278397e-04, -2.27808952e-04,
        -2.26736069e-04, -2.02298164e-04, -1.54376030e-04,
        -8.28504562e-05,  1.20401382e-05,  1.30534172e-04,
         2.72512436e-04,  4.17470932e-04,  5.30719757e-04,
         6.13212585e-04,  6.64234161e-04,  6.83784485e-04,
         6.71863556e-04,  6.28948212e-04,  5.54561615e-04,
         4.48703766e-04,  3.11613083e-04,  1.60932541e-04,
         2.57492065e-05, -9.36388969e-05, -1.97410583e-04,
        -2.85387039e-04, -3.57866287e-04, -4.14848328e-04,
        -4.55856323e-04, -4.81367111e-04, -4.91142273e-04,
        -4.94003296e-04, -5.04493713e-04, -5.23090363e-04,
        -5.49793243e-04, -5.84125519e-04, -6.26087189e-04,
        -6.76155090e-04, -7.33852386e-04, -7.99655914e-04,
        -8.73088837e-04, -9.54151154e-04, -1.04331970e-03,
        -1.13964081e-03, -1.24454498e-03, -1.35707855e-03,
        -1.47819519e-03, -1.60598755e-03, -1.74236298e-03,
        -1.88636780e-03, -2.03704834e-03, -2.18582153e-03,
        -2.30979919e-03, -2.41088867e-03, -2.48718262e-03,
        -2.54249573e-03, -2.57301331e-03, -2.57873535e-03,
        -2.56156921e-03, -2.52151489e-03, -2.45857239e-03,
        -2.38609314e-03, -2.32887268e-03, -2.28881836e-03,
        -2.26211548e-03, -2.25257874e-03, -2.25830078e-03,
        -2.28118896e-03, -2.31742859e-03, -2.37083435e-03,
        -2.43949890e-03, -2.51770020e-03, -2.59590149e-03,
        -2.67410278e-03, -2.75230408e-03, -2.83050537e-03,
        -2.90870667e-03, -2.98690796e-03, -3.06510925e-03,
        -3.14331055e-03, -3.22151184e-03, -3.29399109e-03,
        -3.35121155e-03, -3.39317322e-03, -3.41796875e-03,
        -3.42750549e-03, -3.42178345e-03, -3.40080261e-03,
        -3.36265564e-03, -3.31115723e-03, -3.24249268e-03,
        -3.16429138e-03, -3.08609009e-03, -3.00788879e-03,
        -2.92778015e-03, -2.84957886e-03, -2.77137756e-03,
        -2.69317627e-03, -2.61497498e-03, -2.53677368e-03,
        -2.45857239e-03, -2.38227844e-03, -2.31552124e-03,
        -2.25639343e-03, -2.20489502e-03, -2.15911865e-03,
        -2.12287903e-03, -2.09617615e-03, -2.07519531e-03,
        -2.06184387e-03, -2.05802917e-03, -2.05993652e-03,
        -2.07138062e-03, -2.08854675e-03, -2.11524963e-03,
        -2.14958191e-03, -2.19154358e-03, -2.24304199e-03,
        -2.30026245e-03, -2.36511230e-03, -2.43949890e-03,
        -2.51197815e-03, -2.56919861e-03, -2.60925293e-03,
        -2.63404846e-03, -2.64549255e-03, -2.63786316e-03,
        -2.61688232e-03, -2.58064270e-03, -2.52723694e-03,
        -2.45857239e-03, -2.38037109e-03, -2.30216980e-03,
        -2.22396851e-03, -2.14576721e-03, -2.06756592e-03,
        -1.98936462e-03, -1.91116333e-03, -1.83200836e-03,
        -1.75380707e-03, -1.67560577e-03, -1.60312653e-03,
        -1.54685974e-03, -1.50489807e-03, -1.48010254e-03,
        -1.46961212e-03, -1.47628784e-03, -1.49726868e-03,
        -1.53446198e-03, -1.58786774e-03, -1.65653229e-03,
        -1.73187256e-03, -1.79862976e-03, -1.85871124e-03,
        -1.91116333e-03, -1.95503235e-03, -1.99127197e-03,
        -2.01797485e-03, -2.03895569e-03, -2.05230713e-03,
        -2.05802917e-03, -2.05039978e-03, -2.02941895e-03,
        -1.99317932e-03, -1.93977356e-03, -1.87110901e-03,
        -1.78718567e-03, -1.68704987e-03, -1.57165527e-03,
        -1.44100189e-03, -1.29413605e-03, -1.14631653e-03,
        -1.02138519e-03, -9.20772552e-04, -8.43524933e-04,
        -7.89642334e-04, -7.59124756e-04, -7.52449036e-04,
        -7.69138336e-04, -8.09192657e-04, -8.73088837e-04,
        -9.51290131e-04, -1.02901459e-03, -1.10816956e-03,
        -1.18637085e-03, -1.26457214e-03, -1.34277344e-03,
        -1.42097473e-03, -1.49917603e-03, -1.44100189e-03,
        -1.38187408e-03, -1.32274628e-03, -1.26457214e-03,
        -1.20544434e-03, -1.14631653e-03, -1.08814240e-03,
        -1.02901459e-03, -9.70363617e-04, -9.11235809e-04,
        -8.52584839e-04, -7.93933868e-04, -7.34806061e-04,
        -6.76155090e-04, -6.17504120e-04, -5.58376312e-04,
        -4.99725342e-04, -4.41074371e-04, -3.82184982e-04,
        -3.23295593e-04, -2.64644623e-04, -2.05755234e-04,
        -1.46985054e-04, -8.82148743e-05, -2.93850899e-05,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00]]),
              &#39;time_slice&#39;: 4.0},
         21: {&#39;altitude_cor&#39;: 0,
              &#39;altitude_raw&#39;: 1.2217305,
              &#39;azimuth_cor&#39;: 0,
              &#39;azimuth_raw&#39;: 0.0,
              &#39;dc_to_pe&#39;: array([[0.01648832, 0.01614418, 0.01698802, ..., 0.01671753, 0.0172286 ,
        0.01551135]], dtype=float32),
              &#39;pedestal&#39;: array([[2425.3245, 2515.1167, 2519.167 , ..., 2487.3367, 2518.81  ,
        2424.043 ]], dtype=float32),
              &#39;photo_electron_image&#39;: array([0., 0., 0., ..., 0., 0., 0.], dtype=float32),
              &#39;reference_pulse_shape&#39;: array([[-4.89234924e-04, -4.89234924e-04, -4.89234924e-04,
        -4.89234924e-04, -4.89234924e-04, -4.89234924e-04,
        -4.89234924e-04, -3.33786011e-04,  2.36868858e-04,
         1.22261047e-03,  2.62260437e-03,  4.44030762e-03,
         6.67190552e-03,  9.31549072e-03,  1.23748779e-02,
         1.58538818e-02,  1.97448730e-02,  2.57568359e-02,
         3.67431641e-02,  5.27038574e-02,  7.36694336e-02,
         9.95483398e-02,  1.30371094e-01,  1.66259766e-01,
         2.07153320e-01,  2.52929688e-01,  3.03710938e-01,
         3.57421875e-01,  4.10644531e-01,  4.63378906e-01,
         5.15136719e-01,  5.66894531e-01,  6.18164062e-01,
         6.68945312e-01,  7.19238281e-01,  7.69042969e-01,
         8.17871094e-01,  8.64257812e-01,  9.03808594e-01,
         9.36523438e-01,  9.62402344e-01,  9.81445312e-01,
         9.94140625e-01,  9.99511719e-01,  9.98046875e-01,
         9.89746094e-01,  9.75097656e-01,  9.55566406e-01,
         9.35058594e-01,  9.14062500e-01,  8.92578125e-01,
         8.69628906e-01,  8.46191406e-01,  8.22265625e-01,
         7.97363281e-01,  7.71484375e-01,  7.45117188e-01,
         7.18261719e-01,  6.92871094e-01,  6.68945312e-01,
         6.45507812e-01,  6.24023438e-01,  6.03515625e-01,
         5.83984375e-01,  5.65429688e-01,  5.48339844e-01,
         5.32714844e-01,  5.17578125e-01,  5.03417969e-01,
         4.89257812e-01,  4.75585938e-01,  4.62402344e-01,
         4.49462891e-01,  4.37255859e-01,  4.25292969e-01,
         4.13818359e-01,  4.02587891e-01,  3.91845703e-01,
         3.81347656e-01,  3.70849609e-01,  3.60839844e-01,
         3.50830078e-01,  3.41064453e-01,  3.31298828e-01,
         3.22021484e-01,  3.12744141e-01,  3.03710938e-01,
         2.94921875e-01,  2.86376953e-01,  2.78076172e-01,
         2.70263672e-01,  2.62695312e-01,  2.55615234e-01,
         2.48657227e-01,  2.42065430e-01,  2.35717773e-01,
         2.29736328e-01,  2.23999023e-01,  2.18261719e-01,
         2.12646484e-01,  2.07153320e-01,  2.01782227e-01,
         1.96411133e-01,  1.91162109e-01,  1.86035156e-01,
         1.80908203e-01,  1.75903320e-01,  1.71020508e-01,
         1.66259766e-01,  1.61621094e-01,  1.56982422e-01,
         1.52587891e-01,  1.48193359e-01,  1.44042969e-01,
         1.39892578e-01,  1.35864258e-01,  1.31958008e-01,
         1.28173828e-01,  1.24511719e-01,  1.21032715e-01,
         1.17675781e-01,  1.14440918e-01,  1.11389160e-01,
         1.08398438e-01,  1.05651855e-01,  1.02966309e-01,
         1.00463867e-01,  9.80224609e-02,  9.56420898e-02,
         9.33227539e-02,  9.09423828e-02,  8.86840820e-02,
         8.64257812e-02,  8.41674805e-02,  8.19702148e-02,
         7.98339844e-02,  7.76977539e-02,  7.55615234e-02,
         7.34863281e-02,  7.14111328e-02,  6.93359375e-02,
         6.73217773e-02,  6.52465820e-02,  6.32324219e-02,
         6.12792969e-02,  5.92956543e-02,  5.73120117e-02,
         5.53894043e-02,  5.36193848e-02,  5.19409180e-02,
         5.03540039e-02,  4.89196777e-02,  4.76074219e-02,
         4.63867188e-02,  4.52880859e-02,  4.43115234e-02,
         4.34570312e-02,  4.26635742e-02,  4.18395996e-02,
         4.10156250e-02,  4.01611328e-02,  3.92761230e-02,
         3.83605957e-02,  3.74145508e-02,  3.64685059e-02,
         3.54919434e-02,  3.44848633e-02,  3.34777832e-02,
         3.24401855e-02,  3.14331055e-02,  3.04107666e-02,
         2.94036865e-02,  2.83813477e-02,  2.73590088e-02,
         2.63366699e-02,  2.53295898e-02,  2.43072510e-02,
         2.33154297e-02,  2.23693848e-02,  2.14843750e-02,
         2.06451416e-02,  1.98669434e-02,  1.91345215e-02,
         1.84783936e-02,  1.78527832e-02,  1.73034668e-02,
         1.67999268e-02,  1.63269043e-02,  1.58386230e-02,
         1.53579712e-02,  1.48620605e-02,  1.43585205e-02,
         1.38397217e-02,  1.33209229e-02,  1.27944946e-02,
         1.22604370e-02,  1.17187500e-02,  1.11770630e-02,
         1.06735229e-02,  1.02005005e-02,  9.75799561e-03,
         9.34600830e-03,  8.96453857e-03,  8.62121582e-03,
         8.30078125e-03,  8.01849365e-03,  7.76290894e-03,
         7.52639771e-03,  7.29370117e-03,  7.05718994e-03,
         6.82067871e-03,  6.58798218e-03,  6.35147095e-03,
         6.11495972e-03,  5.88226318e-03,  5.64575195e-03,
         5.41305542e-03,  5.17272949e-03,  4.91333008e-03,
         4.64248657e-03,  4.35256958e-03,  4.05120850e-03,
         3.73268127e-03,  3.39698792e-03,  3.04603577e-03,
         2.67982483e-03,  2.29835510e-03,  1.91879272e-03,
         1.57070160e-03,  1.25312805e-03,  9.67502594e-04,
         7.12871552e-04,  4.89711761e-04,  2.98023224e-04,
         1.37329102e-04,  8.16583633e-06, -8.97049904e-05,
        -1.59263611e-04, -2.05278397e-04, -2.27808952e-04,
        -2.26736069e-04, -2.02298164e-04, -1.54376030e-04,
        -8.28504562e-05,  1.20401382e-05,  1.30534172e-04,
         2.72512436e-04,  4.17470932e-04,  5.30719757e-04,
         6.13212585e-04,  6.64234161e-04,  6.83784485e-04,
         6.71863556e-04,  6.28948212e-04,  5.54561615e-04,
         4.48703766e-04,  3.11613083e-04,  1.60932541e-04,
         2.57492065e-05, -9.36388969e-05, -1.97410583e-04,
        -2.85387039e-04, -3.57866287e-04, -4.14848328e-04,
        -4.55856323e-04, -4.81367111e-04, -4.91142273e-04,
        -4.94003296e-04, -5.04493713e-04, -5.23090363e-04,
        -5.49793243e-04, -5.84125519e-04, -6.26087189e-04,
        -6.76155090e-04, -7.33852386e-04, -7.99655914e-04,
        -8.73088837e-04, -9.54151154e-04, -1.04331970e-03,
        -1.13964081e-03, -1.24454498e-03, -1.35707855e-03,
        -1.47819519e-03, -1.60598755e-03, -1.74236298e-03,
        -1.88636780e-03, -2.03704834e-03, -2.18582153e-03,
        -2.30979919e-03, -2.41088867e-03, -2.48718262e-03,
        -2.54249573e-03, -2.57301331e-03, -2.57873535e-03,
        -2.56156921e-03, -2.52151489e-03, -2.45857239e-03,
        -2.38609314e-03, -2.32887268e-03, -2.28881836e-03,
        -2.26211548e-03, -2.25257874e-03, -2.25830078e-03,
        -2.28118896e-03, -2.31742859e-03, -2.37083435e-03,
        -2.43949890e-03, -2.51770020e-03, -2.59590149e-03,
        -2.67410278e-03, -2.75230408e-03, -2.83050537e-03,
        -2.90870667e-03, -2.98690796e-03, -3.06510925e-03,
        -3.14331055e-03, -3.22151184e-03, -3.29399109e-03,
        -3.35121155e-03, -3.39317322e-03, -3.41796875e-03,
        -3.42750549e-03, -3.42178345e-03, -3.40080261e-03,
        -3.36265564e-03, -3.31115723e-03, -3.24249268e-03,
        -3.16429138e-03, -3.08609009e-03, -3.00788879e-03,
        -2.92778015e-03, -2.84957886e-03, -2.77137756e-03,
        -2.69317627e-03, -2.61497498e-03, -2.53677368e-03,
        -2.45857239e-03, -2.38227844e-03, -2.31552124e-03,
        -2.25639343e-03, -2.20489502e-03, -2.15911865e-03,
        -2.12287903e-03, -2.09617615e-03, -2.07519531e-03,
        -2.06184387e-03, -2.05802917e-03, -2.05993652e-03,
        -2.07138062e-03, -2.08854675e-03, -2.11524963e-03,
        -2.14958191e-03, -2.19154358e-03, -2.24304199e-03,
        -2.30026245e-03, -2.36511230e-03, -2.43949890e-03,
        -2.51197815e-03, -2.56919861e-03, -2.60925293e-03,
        -2.63404846e-03, -2.64549255e-03, -2.63786316e-03,
        -2.61688232e-03, -2.58064270e-03, -2.52723694e-03,
        -2.45857239e-03, -2.38037109e-03, -2.30216980e-03,
        -2.22396851e-03, -2.14576721e-03, -2.06756592e-03,
        -1.98936462e-03, -1.91116333e-03, -1.83200836e-03,
        -1.75380707e-03, -1.67560577e-03, -1.60312653e-03,
        -1.54685974e-03, -1.50489807e-03, -1.48010254e-03,
        -1.46961212e-03, -1.47628784e-03, -1.49726868e-03,
        -1.53446198e-03, -1.58786774e-03, -1.65653229e-03,
        -1.73187256e-03, -1.79862976e-03, -1.85871124e-03,
        -1.91116333e-03, -1.95503235e-03, -1.99127197e-03,
        -2.01797485e-03, -2.03895569e-03, -2.05230713e-03,
        -2.05802917e-03, -2.05039978e-03, -2.02941895e-03,
        -1.99317932e-03, -1.93977356e-03, -1.87110901e-03,
        -1.78718567e-03, -1.68704987e-03, -1.57165527e-03,
        -1.44100189e-03, -1.29413605e-03, -1.14631653e-03,
        -1.02138519e-03, -9.20772552e-04, -8.43524933e-04,
        -7.89642334e-04, -7.59124756e-04, -7.52449036e-04,
        -7.69138336e-04, -8.09192657e-04, -8.73088837e-04,
        -9.51290131e-04, -1.02901459e-03, -1.10816956e-03,
        -1.18637085e-03, -1.26457214e-03, -1.34277344e-03,
        -1.42097473e-03, -1.49917603e-03, -1.44100189e-03,
        -1.38187408e-03, -1.32274628e-03, -1.26457214e-03,
        -1.20544434e-03, -1.14631653e-03, -1.08814240e-03,
        -1.02901459e-03, -9.70363617e-04, -9.11235809e-04,
        -8.52584839e-04, -7.93933868e-04, -7.34806061e-04,
        -6.76155090e-04, -6.17504120e-04, -5.58376312e-04,
        -4.99725342e-04, -4.41074371e-04, -3.82184982e-04,
        -3.23295593e-04, -2.64644623e-04, -2.05755234e-04,
        -1.46985054e-04, -8.82148743e-05, -2.93850899e-05,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00]]),
              &#39;time_slice&#39;: 4.0},
         25: {&#39;altitude_cor&#39;: 0,
              &#39;altitude_raw&#39;: 1.2217305,
              &#39;azimuth_cor&#39;: 0,
              &#39;azimuth_raw&#39;: 0.0,
              &#39;dc_to_pe&#39;: array([[0.0163676 , 0.01685622, 0.01591403, ..., 0.01767909, 0.01592332,
        0.01767167]], dtype=float32),
              &#39;pedestal&#39;: array([[2512.768 , 2485.4065, 2501.8994, ..., 2478.2139, 2517.939 ,
        2476.2256]], dtype=float32),
              &#39;photo_electron_image&#39;: array([0., 0., 0., ..., 0., 0., 0.], dtype=float32),
              &#39;reference_pulse_shape&#39;: array([[-4.89234924e-04, -4.89234924e-04, -4.89234924e-04,
        -4.89234924e-04, -4.89234924e-04, -4.89234924e-04,
        -4.89234924e-04, -3.33786011e-04,  2.36868858e-04,
         1.22261047e-03,  2.62260437e-03,  4.44030762e-03,
         6.67190552e-03,  9.31549072e-03,  1.23748779e-02,
         1.58538818e-02,  1.97448730e-02,  2.57568359e-02,
         3.67431641e-02,  5.27038574e-02,  7.36694336e-02,
         9.95483398e-02,  1.30371094e-01,  1.66259766e-01,
         2.07153320e-01,  2.52929688e-01,  3.03710938e-01,
         3.57421875e-01,  4.10644531e-01,  4.63378906e-01,
         5.15136719e-01,  5.66894531e-01,  6.18164062e-01,
         6.68945312e-01,  7.19238281e-01,  7.69042969e-01,
         8.17871094e-01,  8.64257812e-01,  9.03808594e-01,
         9.36523438e-01,  9.62402344e-01,  9.81445312e-01,
         9.94140625e-01,  9.99511719e-01,  9.98046875e-01,
         9.89746094e-01,  9.75097656e-01,  9.55566406e-01,
         9.35058594e-01,  9.14062500e-01,  8.92578125e-01,
         8.69628906e-01,  8.46191406e-01,  8.22265625e-01,
         7.97363281e-01,  7.71484375e-01,  7.45117188e-01,
         7.18261719e-01,  6.92871094e-01,  6.68945312e-01,
         6.45507812e-01,  6.24023438e-01,  6.03515625e-01,
         5.83984375e-01,  5.65429688e-01,  5.48339844e-01,
         5.32714844e-01,  5.17578125e-01,  5.03417969e-01,
         4.89257812e-01,  4.75585938e-01,  4.62402344e-01,
         4.49462891e-01,  4.37255859e-01,  4.25292969e-01,
         4.13818359e-01,  4.02587891e-01,  3.91845703e-01,
         3.81347656e-01,  3.70849609e-01,  3.60839844e-01,
         3.50830078e-01,  3.41064453e-01,  3.31298828e-01,
         3.22021484e-01,  3.12744141e-01,  3.03710938e-01,
         2.94921875e-01,  2.86376953e-01,  2.78076172e-01,
         2.70263672e-01,  2.62695312e-01,  2.55615234e-01,
         2.48657227e-01,  2.42065430e-01,  2.35717773e-01,
         2.29736328e-01,  2.23999023e-01,  2.18261719e-01,
         2.12646484e-01,  2.07153320e-01,  2.01782227e-01,
         1.96411133e-01,  1.91162109e-01,  1.86035156e-01,
         1.80908203e-01,  1.75903320e-01,  1.71020508e-01,
         1.66259766e-01,  1.61621094e-01,  1.56982422e-01,
         1.52587891e-01,  1.48193359e-01,  1.44042969e-01,
         1.39892578e-01,  1.35864258e-01,  1.31958008e-01,
         1.28173828e-01,  1.24511719e-01,  1.21032715e-01,
         1.17675781e-01,  1.14440918e-01,  1.11389160e-01,
         1.08398438e-01,  1.05651855e-01,  1.02966309e-01,
         1.00463867e-01,  9.80224609e-02,  9.56420898e-02,
         9.33227539e-02,  9.09423828e-02,  8.86840820e-02,
         8.64257812e-02,  8.41674805e-02,  8.19702148e-02,
         7.98339844e-02,  7.76977539e-02,  7.55615234e-02,
         7.34863281e-02,  7.14111328e-02,  6.93359375e-02,
         6.73217773e-02,  6.52465820e-02,  6.32324219e-02,
         6.12792969e-02,  5.92956543e-02,  5.73120117e-02,
         5.53894043e-02,  5.36193848e-02,  5.19409180e-02,
         5.03540039e-02,  4.89196777e-02,  4.76074219e-02,
         4.63867188e-02,  4.52880859e-02,  4.43115234e-02,
         4.34570312e-02,  4.26635742e-02,  4.18395996e-02,
         4.10156250e-02,  4.01611328e-02,  3.92761230e-02,
         3.83605957e-02,  3.74145508e-02,  3.64685059e-02,
         3.54919434e-02,  3.44848633e-02,  3.34777832e-02,
         3.24401855e-02,  3.14331055e-02,  3.04107666e-02,
         2.94036865e-02,  2.83813477e-02,  2.73590088e-02,
         2.63366699e-02,  2.53295898e-02,  2.43072510e-02,
         2.33154297e-02,  2.23693848e-02,  2.14843750e-02,
         2.06451416e-02,  1.98669434e-02,  1.91345215e-02,
         1.84783936e-02,  1.78527832e-02,  1.73034668e-02,
         1.67999268e-02,  1.63269043e-02,  1.58386230e-02,
         1.53579712e-02,  1.48620605e-02,  1.43585205e-02,
         1.38397217e-02,  1.33209229e-02,  1.27944946e-02,
         1.22604370e-02,  1.17187500e-02,  1.11770630e-02,
         1.06735229e-02,  1.02005005e-02,  9.75799561e-03,
         9.34600830e-03,  8.96453857e-03,  8.62121582e-03,
         8.30078125e-03,  8.01849365e-03,  7.76290894e-03,
         7.52639771e-03,  7.29370117e-03,  7.05718994e-03,
         6.82067871e-03,  6.58798218e-03,  6.35147095e-03,
         6.11495972e-03,  5.88226318e-03,  5.64575195e-03,
         5.41305542e-03,  5.17272949e-03,  4.91333008e-03,
         4.64248657e-03,  4.35256958e-03,  4.05120850e-03,
         3.73268127e-03,  3.39698792e-03,  3.04603577e-03,
         2.67982483e-03,  2.29835510e-03,  1.91879272e-03,
         1.57070160e-03,  1.25312805e-03,  9.67502594e-04,
         7.12871552e-04,  4.89711761e-04,  2.98023224e-04,
         1.37329102e-04,  8.16583633e-06, -8.97049904e-05,
        -1.59263611e-04, -2.05278397e-04, -2.27808952e-04,
        -2.26736069e-04, -2.02298164e-04, -1.54376030e-04,
        -8.28504562e-05,  1.20401382e-05,  1.30534172e-04,
         2.72512436e-04,  4.17470932e-04,  5.30719757e-04,
         6.13212585e-04,  6.64234161e-04,  6.83784485e-04,
         6.71863556e-04,  6.28948212e-04,  5.54561615e-04,
         4.48703766e-04,  3.11613083e-04,  1.60932541e-04,
         2.57492065e-05, -9.36388969e-05, -1.97410583e-04,
        -2.85387039e-04, -3.57866287e-04, -4.14848328e-04,
        -4.55856323e-04, -4.81367111e-04, -4.91142273e-04,
        -4.94003296e-04, -5.04493713e-04, -5.23090363e-04,
        -5.49793243e-04, -5.84125519e-04, -6.26087189e-04,
        -6.76155090e-04, -7.33852386e-04, -7.99655914e-04,
        -8.73088837e-04, -9.54151154e-04, -1.04331970e-03,
        -1.13964081e-03, -1.24454498e-03, -1.35707855e-03,
        -1.47819519e-03, -1.60598755e-03, -1.74236298e-03,
        -1.88636780e-03, -2.03704834e-03, -2.18582153e-03,
        -2.30979919e-03, -2.41088867e-03, -2.48718262e-03,
        -2.54249573e-03, -2.57301331e-03, -2.57873535e-03,
        -2.56156921e-03, -2.52151489e-03, -2.45857239e-03,
        -2.38609314e-03, -2.32887268e-03, -2.28881836e-03,
        -2.26211548e-03, -2.25257874e-03, -2.25830078e-03,
        -2.28118896e-03, -2.31742859e-03, -2.37083435e-03,
        -2.43949890e-03, -2.51770020e-03, -2.59590149e-03,
        -2.67410278e-03, -2.75230408e-03, -2.83050537e-03,
        -2.90870667e-03, -2.98690796e-03, -3.06510925e-03,
        -3.14331055e-03, -3.22151184e-03, -3.29399109e-03,
        -3.35121155e-03, -3.39317322e-03, -3.41796875e-03,
        -3.42750549e-03, -3.42178345e-03, -3.40080261e-03,
        -3.36265564e-03, -3.31115723e-03, -3.24249268e-03,
        -3.16429138e-03, -3.08609009e-03, -3.00788879e-03,
        -2.92778015e-03, -2.84957886e-03, -2.77137756e-03,
        -2.69317627e-03, -2.61497498e-03, -2.53677368e-03,
        -2.45857239e-03, -2.38227844e-03, -2.31552124e-03,
        -2.25639343e-03, -2.20489502e-03, -2.15911865e-03,
        -2.12287903e-03, -2.09617615e-03, -2.07519531e-03,
        -2.06184387e-03, -2.05802917e-03, -2.05993652e-03,
        -2.07138062e-03, -2.08854675e-03, -2.11524963e-03,
        -2.14958191e-03, -2.19154358e-03, -2.24304199e-03,
        -2.30026245e-03, -2.36511230e-03, -2.43949890e-03,
        -2.51197815e-03, -2.56919861e-03, -2.60925293e-03,
        -2.63404846e-03, -2.64549255e-03, -2.63786316e-03,
        -2.61688232e-03, -2.58064270e-03, -2.52723694e-03,
        -2.45857239e-03, -2.38037109e-03, -2.30216980e-03,
        -2.22396851e-03, -2.14576721e-03, -2.06756592e-03,
        -1.98936462e-03, -1.91116333e-03, -1.83200836e-03,
        -1.75380707e-03, -1.67560577e-03, -1.60312653e-03,
        -1.54685974e-03, -1.50489807e-03, -1.48010254e-03,
        -1.46961212e-03, -1.47628784e-03, -1.49726868e-03,
        -1.53446198e-03, -1.58786774e-03, -1.65653229e-03,
        -1.73187256e-03, -1.79862976e-03, -1.85871124e-03,
        -1.91116333e-03, -1.95503235e-03, -1.99127197e-03,
        -2.01797485e-03, -2.03895569e-03, -2.05230713e-03,
        -2.05802917e-03, -2.05039978e-03, -2.02941895e-03,
        -1.99317932e-03, -1.93977356e-03, -1.87110901e-03,
        -1.78718567e-03, -1.68704987e-03, -1.57165527e-03,
        -1.44100189e-03, -1.29413605e-03, -1.14631653e-03,
        -1.02138519e-03, -9.20772552e-04, -8.43524933e-04,
        -7.89642334e-04, -7.59124756e-04, -7.52449036e-04,
        -7.69138336e-04, -8.09192657e-04, -8.73088837e-04,
        -9.51290131e-04, -1.02901459e-03, -1.10816956e-03,
        -1.18637085e-03, -1.26457214e-03, -1.34277344e-03,
        -1.42097473e-03, -1.49917603e-03, -1.44100189e-03,
        -1.38187408e-03, -1.32274628e-03, -1.26457214e-03,
        -1.20544434e-03, -1.14631653e-03, -1.08814240e-03,
        -1.02901459e-03, -9.70363617e-04, -9.11235809e-04,
        -8.52584839e-04, -7.93933868e-04, -7.34806061e-04,
        -6.76155090e-04, -6.17504120e-04, -5.58376312e-04,
        -4.99725342e-04, -4.41074371e-04, -3.82184982e-04,
        -3.23295593e-04, -2.64644623e-04, -2.05755234e-04,
        -1.46985054e-04, -8.82148743e-05, -2.93850899e-05,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00,  0.00000000e+00]]),
              &#39;time_slice&#39;: 4.0},
         34: {&#39;altitude_cor&#39;: 0,
              &#39;altitude_raw&#39;: 1.2217305,
              &#39;azimuth_cor&#39;: 0,
              &#39;azimuth_raw&#39;: 0.0,
              &#39;dc_to_pe&#39;: array([[0.01625161, 0.01585839, 0.01550947, ..., 0.01543783, 0.01607135,
        0.01598294],
       [0.6502725 , 0.63453853, 0.6205772 , ..., 0.61771107, 0.64305985,
        0.63952243]], dtype=float32),
              &#39;pedestal&#39;: array([[971., 971., 971., ..., 971., 971., 971.],
       [961., 961., 961., ..., 961., 961., 961.]], dtype=float32),
              &#39;photo_electron_image&#39;: array([0., 0., 0., ..., 0., 0., 0.], dtype=float32),
              &#39;reference_pulse_shape&#39;: array([[ 5.29766083e-04,  4.00924683e-03,  1.12609863e-02,
         2.22320557e-02,  3.67431641e-02,  5.45349121e-02,
         7.53173828e-02,  9.86938477e-02,  1.24450684e-01,
         1.52099609e-01,  1.81640625e-01,  2.12402344e-01,
         2.44384766e-01,  2.77099609e-01,  3.10791016e-01,
         3.44482422e-01,  3.78662109e-01,  4.12597656e-01,
         4.46533203e-01,  4.80224609e-01,  5.13183594e-01,
         5.45898438e-01,  5.77636719e-01,  6.08398438e-01,
         6.38671875e-01,  6.67480469e-01,  6.95800781e-01,
         7.22656250e-01,  7.48535156e-01,  7.72949219e-01,
         7.96386719e-01,  8.18359375e-01,  8.39355469e-01,
         8.58886719e-01,  8.76953125e-01,  8.94042969e-01,
         9.09667969e-01,  9.23828125e-01,  9.37011719e-01,
         9.48730469e-01,  9.58984375e-01,  9.68261719e-01,
         9.76562500e-01,  9.82910156e-01,  9.88769531e-01,
         9.93164062e-01,  9.96093750e-01,  9.98535156e-01,
         9.99511719e-01,  9.99511719e-01,  9.99023438e-01,
         9.98046875e-01,  9.95605469e-01,  9.92187500e-01,
         9.88281250e-01,  9.83398438e-01,  9.77050781e-01,
         9.70703125e-01,  9.62890625e-01,  9.55078125e-01,
         9.45800781e-01,  9.36523438e-01,  9.26269531e-01,
         9.15039062e-01,  9.03808594e-01,  8.91601562e-01,
         8.79394531e-01,  8.66210938e-01,  8.53027344e-01,
         8.38867188e-01,  8.24707031e-01,  8.10058594e-01,
         7.94921875e-01,  7.79296875e-01,  7.63671875e-01,
         7.48046875e-01,  7.31445312e-01,  7.15332031e-01,
         6.98242188e-01,  6.81640625e-01,  6.64550781e-01,
         6.47460938e-01,  6.30371094e-01,  6.12792969e-01,
         5.95214844e-01,  5.77636719e-01,  5.60058594e-01,
         5.42480469e-01,  5.24902344e-01,  5.07324219e-01,
         4.89501953e-01,  4.71923828e-01,  4.54345703e-01,
         4.36767578e-01,  4.19189453e-01,  4.01855469e-01,
         3.84521484e-01,  3.67187500e-01,  3.50097656e-01,
         3.33007812e-01,  3.16162109e-01,  2.99560547e-01,
         2.82714844e-01,  2.66357422e-01,  2.50000000e-01,
         2.33886719e-01,  2.17895508e-01,  2.02148438e-01,
         1.86523438e-01,  1.71020508e-01,  1.55761719e-01,
         1.40747070e-01,  1.25854492e-01,  1.11267090e-01,
         9.68017578e-02,  8.25805664e-02,  6.85424805e-02,
         5.47790527e-02,  4.11987305e-02,  2.78320312e-02,
         1.47018433e-02,  1.79767609e-03, -1.08795166e-02,
        -2.33306885e-02, -3.55529785e-02, -4.75463867e-02,
        -5.92956543e-02, -7.08007812e-02, -8.20922852e-02,
        -9.32006836e-02, -1.04003906e-01, -1.14624023e-01,
        -1.25000000e-01, -1.35131836e-01, -1.45019531e-01,
        -1.54785156e-01, -1.64184570e-01, -1.73461914e-01,
        -1.82373047e-01, -1.91162109e-01, -1.99829102e-01,
        -2.08129883e-01, -2.16308594e-01, -2.24121094e-01,
        -2.31811523e-01, -2.39379883e-01, -2.46582031e-01,
        -2.53662109e-01, -2.60498047e-01, -2.67089844e-01,
        -2.73437500e-01, -2.79785156e-01, -2.85888672e-01,
        -2.91748047e-01, -2.97363281e-01, -3.02734375e-01,
        -3.08105469e-01, -3.13232422e-01, -3.18115234e-01,
        -3.22753906e-01, -3.27392578e-01, -3.31787109e-01,
        -3.35937500e-01, -3.39843750e-01, -3.43750000e-01,
        -3.47412109e-01, -3.51074219e-01, -3.54492188e-01,
        -3.57666016e-01, -3.60595703e-01, -3.63525391e-01,
        -3.66210938e-01, -3.68896484e-01, -3.71337891e-01,
        -3.73779297e-01, -3.75976562e-01, -3.77929688e-01,
        -3.79882812e-01, -3.81591797e-01, -3.83300781e-01,
        -3.84765625e-01, -3.86230469e-01, -3.87695312e-01,
        -3.88671875e-01, -3.89892578e-01, -3.90869141e-01,
        -3.91601562e-01, -3.92333984e-01, -3.92822266e-01,
        -3.93554688e-01, -3.93798828e-01, -3.94287109e-01,
        -3.94287109e-01, -3.94531250e-01, -3.94531250e-01,
        -3.94531250e-01, -3.94287109e-01, -3.94042969e-01,
        -3.93798828e-01, -3.93554688e-01, -3.93066406e-01,
        -3.92333984e-01, -3.91845703e-01, -3.91113281e-01,
        -3.90380859e-01, -3.89648438e-01, -3.88671875e-01,
        -3.87695312e-01, -3.86718750e-01, -3.85498047e-01,
        -3.84521484e-01, -3.83300781e-01, -3.82080078e-01,
        -3.80615234e-01, -3.79394531e-01, -3.77929688e-01,
        -3.76464844e-01, -3.75000000e-01, -3.73291016e-01,
        -3.71826172e-01, -3.70117188e-01, -3.68408203e-01,
        -3.66699219e-01, -3.64990234e-01, -3.63037109e-01,
        -3.61328125e-01, -3.59375000e-01, -3.57421875e-01,
        -3.55712891e-01, -3.53515625e-01, -3.51562500e-01,
        -3.49609375e-01, -3.47656250e-01, -3.45458984e-01,
        -3.43505859e-01, -3.41308594e-01, -3.39111328e-01,
        -3.36914062e-01, -3.34716797e-01, -3.32763672e-01,
        -3.30322266e-01, -3.28125000e-01, -3.25927734e-01,
        -3.23730469e-01, -3.21533203e-01, -3.19091797e-01,
        -3.16894531e-01, -3.14453125e-01, -3.12255859e-01,
        -3.09814453e-01, -3.07617188e-01, -3.05175781e-01,
        -3.02978516e-01, -3.00537109e-01, -2.98095703e-01,
        -2.95898438e-01, -2.93457031e-01, -2.91015625e-01,
        -2.88818359e-01, -2.86376953e-01, -2.83935547e-01,
        -2.81494141e-01, -2.79296875e-01, -2.76855469e-01,
        -2.74414062e-01, -2.72216797e-01, -2.69775391e-01,
        -2.67333984e-01, -2.64892578e-01, -2.62695312e-01,
        -2.60253906e-01, -2.58056641e-01, -2.55615234e-01,
        -2.53173828e-01, -2.50976562e-01, -2.48657227e-01,
        -2.46337891e-01, -2.44018555e-01, -2.41699219e-01,
        -2.39501953e-01, -2.37182617e-01, -2.34863281e-01,
        -2.32666016e-01, -2.30346680e-01, -2.28149414e-01,
        -2.25830078e-01, -2.23632812e-01, -2.21435547e-01,
        -2.19238281e-01, -2.17041016e-01, -2.14843750e-01,
        -2.12646484e-01, -2.10449219e-01, -2.08374023e-01,
        -2.06176758e-01, -2.04101562e-01, -2.01904297e-01,
        -1.99829102e-01, -1.97753906e-01, -1.95678711e-01,
        -1.93603516e-01, -1.91528320e-01, -1.89453125e-01,
        -1.87500000e-01, -1.85424805e-01, -1.83471680e-01,
        -1.81518555e-01, -1.79443359e-01, -1.77490234e-01,
        -1.75659180e-01, -1.73706055e-01, -1.71752930e-01,
        -1.69799805e-01, -1.67968750e-01, -1.66137695e-01,
        -1.64184570e-01, -1.62353516e-01, -1.60522461e-01,
        -1.58691406e-01, -1.56982422e-01, -1.55151367e-01,
        -1.53442383e-01, -1.51611328e-01, -1.49902344e-01,
        -1.48193359e-01, -1.46484375e-01, -1.44775391e-01,
        -1.43066406e-01, -1.41357422e-01, -1.39770508e-01,
        -1.38061523e-01, -1.36474609e-01, -1.34887695e-01,
        -1.33300781e-01, -1.31713867e-01, -1.30126953e-01,
        -1.28540039e-01, -1.27075195e-01, -1.25488281e-01,
        -1.24023438e-01, -1.22497559e-01, -1.21032715e-01,
        -1.19567871e-01, -1.18103027e-01, -1.16699219e-01,
        -1.15234375e-01, -1.13830566e-01, -1.12426758e-01,
        -1.11083984e-01, -1.09680176e-01, -1.08337402e-01,
        -1.06994629e-01, -1.05651855e-01, -1.04370117e-01,
        -1.03027344e-01, -1.01745605e-01, -1.00463867e-01,
        -9.92431641e-02, -9.79614258e-02, -9.67407227e-02,
        -9.55200195e-02, -9.42993164e-02, -9.30786133e-02,
        -9.19189453e-02, -9.07592773e-02, -8.95996094e-02,
        -8.84399414e-02, -8.72802734e-02, -8.61816406e-02,
        -8.50830078e-02, -8.39843750e-02, -8.28857422e-02,
        -8.17871094e-02, -8.07495117e-02, -7.97119141e-02,
        -7.86743164e-02, -7.76367188e-02, -7.65991211e-02,
        -7.56225586e-02, -7.46459961e-02, -7.36694336e-02,
        -7.26928711e-02, -7.17163086e-02, -7.08007812e-02,
        -6.98242188e-02, -6.89086914e-02, -6.79931641e-02,
        -6.70776367e-02, -6.62231445e-02, -6.53076172e-02,
        -6.44531250e-02, -6.35986328e-02, -6.27441406e-02,
        -6.18896484e-02, -6.10656738e-02, -6.02416992e-02,
        -5.94177246e-02, -5.86242676e-02, -5.78308105e-02,
        -5.70373535e-02],
       [ 5.29766083e-04,  4.00924683e-03,  1.12609863e-02,
         2.22320557e-02,  3.67431641e-02,  5.45349121e-02,
         7.53173828e-02,  9.86938477e-02,  1.24450684e-01,
         1.52099609e-01,  1.81640625e-01,  2.12402344e-01,
         2.44384766e-01,  2.77099609e-01,  3.10791016e-01,
         3.44482422e-01,  3.78662109e-01,  4.12597656e-01,
         4.46533203e-01,  4.80224609e-01,  5.13183594e-01,
         5.45898438e-01,  5.77636719e-01,  6.08398438e-01,
         6.38671875e-01,  6.67480469e-01,  6.95800781e-01,
         7.22656250e-01,  7.48535156e-01,  7.72949219e-01,
         7.96386719e-01,  8.18359375e-01,  8.39355469e-01,
         8.58886719e-01,  8.76953125e-01,  8.94042969e-01,
         9.09667969e-01,  9.23828125e-01,  9.37011719e-01,
         9.48730469e-01,  9.58984375e-01,  9.68261719e-01,
         9.76562500e-01,  9.82910156e-01,  9.88769531e-01,
         9.93164062e-01,  9.96093750e-01,  9.98535156e-01,
         9.99511719e-01,  9.99511719e-01,  9.99023438e-01,
         9.98046875e-01,  9.95605469e-01,  9.92187500e-01,
         9.88281250e-01,  9.83398438e-01,  9.77050781e-01,
         9.70703125e-01,  9.62890625e-01,  9.55078125e-01,
         9.45800781e-01,  9.36523438e-01,  9.26269531e-01,
         9.15039062e-01,  9.03808594e-01,  8.91601562e-01,
         8.79394531e-01,  8.66210938e-01,  8.53027344e-01,
         8.38867188e-01,  8.24707031e-01,  8.10058594e-01,
         7.94921875e-01,  7.79296875e-01,  7.63671875e-01,
         7.48046875e-01,  7.31445312e-01,  7.15332031e-01,
         6.98242188e-01,  6.81640625e-01,  6.64550781e-01,
         6.47460938e-01,  6.30371094e-01,  6.12792969e-01,
         5.95214844e-01,  5.77636719e-01,  5.60058594e-01,
         5.42480469e-01,  5.24902344e-01,  5.07324219e-01,
         4.89501953e-01,  4.71923828e-01,  4.54345703e-01,
         4.36767578e-01,  4.19189453e-01,  4.01855469e-01,
         3.84521484e-01,  3.67187500e-01,  3.50097656e-01,
         3.33007812e-01,  3.16162109e-01,  2.99560547e-01,
         2.82714844e-01,  2.66357422e-01,  2.50000000e-01,
         2.33886719e-01,  2.17895508e-01,  2.02148438e-01,
         1.86523438e-01,  1.71020508e-01,  1.55761719e-01,
         1.40747070e-01,  1.25854492e-01,  1.11267090e-01,
         9.68017578e-02,  8.25805664e-02,  6.85424805e-02,
         5.47790527e-02,  4.11987305e-02,  2.78320312e-02,
         1.47018433e-02,  1.79767609e-03, -1.08795166e-02,
        -2.33306885e-02, -3.55529785e-02, -4.75463867e-02,
        -5.92956543e-02, -7.08007812e-02, -8.20922852e-02,
        -9.32006836e-02, -1.04003906e-01, -1.14624023e-01,
        -1.25000000e-01, -1.35131836e-01, -1.45019531e-01,
        -1.54785156e-01, -1.64184570e-01, -1.73461914e-01,
        -1.82373047e-01, -1.91162109e-01, -1.99829102e-01,
        -2.08129883e-01, -2.16308594e-01, -2.24121094e-01,
        -2.31811523e-01, -2.39379883e-01, -2.46582031e-01,
        -2.53662109e-01, -2.60498047e-01, -2.67089844e-01,
        -2.73437500e-01, -2.79785156e-01, -2.85888672e-01,
        -2.91748047e-01, -2.97363281e-01, -3.02734375e-01,
        -3.08105469e-01, -3.13232422e-01, -3.18115234e-01,
        -3.22753906e-01, -3.27392578e-01, -3.31787109e-01,
        -3.35937500e-01, -3.39843750e-01, -3.43750000e-01,
        -3.47412109e-01, -3.51074219e-01, -3.54492188e-01,
        -3.57666016e-01, -3.60595703e-01, -3.63525391e-01,
        -3.66210938e-01, -3.68896484e-01, -3.71337891e-01,
        -3.73779297e-01, -3.75976562e-01, -3.77929688e-01,
        -3.79882812e-01, -3.81591797e-01, -3.83300781e-01,
        -3.84765625e-01, -3.86230469e-01, -3.87695312e-01,
        -3.88671875e-01, -3.89892578e-01, -3.90869141e-01,
        -3.91601562e-01, -3.92333984e-01, -3.92822266e-01,
        -3.93554688e-01, -3.93798828e-01, -3.94287109e-01,
        -3.94287109e-01, -3.94531250e-01, -3.94531250e-01,
        -3.94531250e-01, -3.94287109e-01, -3.94042969e-01,
        -3.93798828e-01, -3.93554688e-01, -3.93066406e-01,
        -3.92333984e-01, -3.91845703e-01, -3.91113281e-01,
        -3.90380859e-01, -3.89648438e-01, -3.88671875e-01,
        -3.87695312e-01, -3.86718750e-01, -3.85498047e-01,
        -3.84521484e-01, -3.83300781e-01, -3.82080078e-01,
        -3.80615234e-01, -3.79394531e-01, -3.77929688e-01,
        -3.76464844e-01, -3.75000000e-01, -3.73291016e-01,
        -3.71826172e-01, -3.70117188e-01, -3.68408203e-01,
        -3.66699219e-01, -3.64990234e-01, -3.63037109e-01,
        -3.61328125e-01, -3.59375000e-01, -3.57421875e-01,
        -3.55712891e-01, -3.53515625e-01, -3.51562500e-01,
        -3.49609375e-01, -3.47656250e-01, -3.45458984e-01,
        -3.43505859e-01, -3.41308594e-01, -3.39111328e-01,
        -3.36914062e-01, -3.34716797e-01, -3.32763672e-01,
        -3.30322266e-01, -3.28125000e-01, -3.25927734e-01,
        -3.23730469e-01, -3.21533203e-01, -3.19091797e-01,
        -3.16894531e-01, -3.14453125e-01, -3.12255859e-01,
        -3.09814453e-01, -3.07617188e-01, -3.05175781e-01,
        -3.02978516e-01, -3.00537109e-01, -2.98095703e-01,
        -2.95898438e-01, -2.93457031e-01, -2.91015625e-01,
        -2.88818359e-01, -2.86376953e-01, -2.83935547e-01,
        -2.81494141e-01, -2.79296875e-01, -2.76855469e-01,
        -2.74414062e-01, -2.72216797e-01, -2.69775391e-01,
        -2.67333984e-01, -2.64892578e-01, -2.62695312e-01,
        -2.60253906e-01, -2.58056641e-01, -2.55615234e-01,
        -2.53173828e-01, -2.50976562e-01, -2.48657227e-01,
        -2.46337891e-01, -2.44018555e-01, -2.41699219e-01,
        -2.39501953e-01, -2.37182617e-01, -2.34863281e-01,
        -2.32666016e-01, -2.30346680e-01, -2.28149414e-01,
        -2.25830078e-01, -2.23632812e-01, -2.21435547e-01,
        -2.19238281e-01, -2.17041016e-01, -2.14843750e-01,
        -2.12646484e-01, -2.10449219e-01, -2.08374023e-01,
        -2.06176758e-01, -2.04101562e-01, -2.01904297e-01,
        -1.99829102e-01, -1.97753906e-01, -1.95678711e-01,
        -1.93603516e-01, -1.91528320e-01, -1.89453125e-01,
        -1.87500000e-01, -1.85424805e-01, -1.83471680e-01,
        -1.81518555e-01, -1.79443359e-01, -1.77490234e-01,
        -1.75659180e-01, -1.73706055e-01, -1.71752930e-01,
        -1.69799805e-01, -1.67968750e-01, -1.66137695e-01,
        -1.64184570e-01, -1.62353516e-01, -1.60522461e-01,
        -1.58691406e-01, -1.56982422e-01, -1.55151367e-01,
        -1.53442383e-01, -1.51611328e-01, -1.49902344e-01,
        -1.48193359e-01, -1.46484375e-01, -1.44775391e-01,
        -1.43066406e-01, -1.41357422e-01, -1.39770508e-01,
        -1.38061523e-01, -1.36474609e-01, -1.34887695e-01,
        -1.33300781e-01, -1.31713867e-01, -1.30126953e-01,
        -1.28540039e-01, -1.27075195e-01, -1.25488281e-01,
        -1.24023438e-01, -1.22497559e-01, -1.21032715e-01,
        -1.19567871e-01, -1.18103027e-01, -1.16699219e-01,
        -1.15234375e-01, -1.13830566e-01, -1.12426758e-01,
        -1.11083984e-01, -1.09680176e-01, -1.08337402e-01,
        -1.06994629e-01, -1.05651855e-01, -1.04370117e-01,
        -1.03027344e-01, -1.01745605e-01, -1.00463867e-01,
        -9.92431641e-02, -9.79614258e-02, -9.67407227e-02,
        -9.55200195e-02, -9.42993164e-02, -9.30786133e-02,
        -9.19189453e-02, -9.07592773e-02, -8.95996094e-02,
        -8.84399414e-02, -8.72802734e-02, -8.61816406e-02,
        -8.50830078e-02, -8.39843750e-02, -8.28857422e-02,
        -8.17871094e-02, -8.07495117e-02, -7.97119141e-02,
        -7.86743164e-02, -7.76367188e-02, -7.65991211e-02,
        -7.56225586e-02, -7.46459961e-02, -7.36694336e-02,
        -7.26928711e-02, -7.17163086e-02, -7.08007812e-02,
        -6.98242188e-02, -6.89086914e-02, -6.79931641e-02,
        -6.70776367e-02, -6.62231445e-02, -6.53076172e-02,
        -6.44531250e-02, -6.35986328e-02, -6.27441406e-02,
        -6.18896484e-02, -6.10656738e-02, -6.02416992e-02,
        -5.94177246e-02, -5.86242676e-02, -5.78308105e-02,
        -5.70373535e-02]]),
              &#39;time_slice&#39;: 2.0}},
 &#39;x_max&#39;: &lt;Quantity 287.61904907 g / cm2&gt;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">tels_with_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{25, 34, 13, 21}
</pre></div></div>
</div>
<p>note that the event has 2 telescopes in it: 38,40… Let’s try the next one:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event</span> <span class="o">=</span> <span class="n">seeker</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># get the next event</span>
<span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">tels_with_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{34, 36, 7, 42, 13, 16, 19, 25, 28}
</pre></div></div>
</div>
<p>now, we have a larger event with many telescopes… Let’s look at the data from <strong>CT7</strong>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">teldata</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">tel</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">teldata</span><span class="p">)</span>
<span class="n">teldata</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;image&#39;: array([[2619, 2043, 2962, ..., 2123, 2369, 2594]], dtype=uint64),
 &#39;num_samples&#39;: 25,
 &#39;num_trig_pix&#39;: 0,
 &#39;trig_pix_id&#39;: None,
 &#39;trigger_time&#39;: None,
 &#39;trigger_type&#39;: 0,
 &#39;waveform&#39;: array([[[107,  93,  80, ..., 115, 106, 103],
        [ 71,  75,  68, ...,  92, 102, 105],
        [ 97, 103, 113, ..., 138, 127, 108],
        ...,
        [ 87,  88,  89, ...,  67,  91, 113],
        [ 51,  63,  89, ...,  69,  68,  56],
        [ 67,  73,  91, ...,  88,  75,  63]]], dtype=uint16)}
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>ctapipe.io.containers.R0CameraContainer:
                  trigger_time: Telescope trigger time, start of waveform
                                readout, None for MCs
                  trigger_type: camera&#39;s event trigger type if applicable
                  num_trig_pix: Number of trigger groups (sectors) listed
                   trig_pix_id: pixels involved in the camera trigger
                         image: numpy array containing integrated ADC data
                                (n_channels x n_pixels) DEPRECATED
                      waveform: numpy array containing ADC samples(n_channels x
                                n_pixels, n_samples)
                   num_samples: number of time samples for telescope
</pre></div>
</div>
</div>
<p>Note that some values are unit quantities (<code class="docutils literal notranslate"><span class="pre">astropy.units.Quantity</span></code>) or angular quantities (<code class="docutils literal notranslate"><span class="pre">astropy.coordinates.Angle</span></code>), and you can easily maniuplate them:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">energy</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$1.8637499 \; \mathrm{TeV}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GeV&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$1863.7499 \; \mathrm{GeV}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">energy</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$2.9860565 \times 10^{-7} \; \mathrm{J}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">event</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">alt</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$1.19518\mathrm{rad}$</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Altitude in degrees:&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">mc</span><span class="o">.</span><span class="n">alt</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Altitude in degrees: 68.47897801473843
</pre></div></div>
</div>
</div>
<div class="section" id="Look-for-signal-pixels-in-a-camera">
<h2>Look for signal pixels in a camera<a class="headerlink" href="#Look-for-signal-pixels-in-a-camera" title="Permalink to this headline">¶</a></h2>
<p>again, <code class="docutils literal notranslate"><span class="pre">event.r0.tel[x]</span></code> contains a data structure for the telescope data, with some fields like <code class="docutils literal notranslate"><span class="pre">waveform</span></code>.</p>
<p>Let’s make a 2D plot of the sample data (sample vs pixel), so we can see if we see which pixels contain Cherenkov light signals:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">teldata</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># note the [0] is for channel 0</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;sample number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pixel_id&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Text(0, 0.5, &#39;Pixel_id&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_23_1.png" src="../_images/tutorials_raw_data_exploration_23_1.png" />
</div>
</div>
<p>Let’s zoom in to see if we can identify the pixels that have the Cherenkov signal in them</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">teldata</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">260</span><span class="p">,</span><span class="mi">290</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;sample number&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;pixel_id&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;waveform[0] is an array of shape (N_pix,N_slice) =&quot;</span><span class="p">,</span><span class="n">teldata</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
waveform[0] is an array of shape (N_pix,N_slice) = (1764, 25)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_25_1.png" src="../_images/tutorials_raw_data_exploration_25_1.png" />
</div>
</div>
<p>Now we can really see that some pixels have a signal in them!</p>
<p>Lets look at a 1D plot of pixel 270 in channel 0 and see the signal:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">trace</span> <span class="o">=</span> <span class="n">teldata</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">270</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&lt;matplotlib.lines.Line2D at 0x7fedcdf77a20&gt;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_27_1.png" src="../_images/tutorials_raw_data_exploration_27_1.png" />
</div>
</div>
<p>Great! It looks like a <em>standard Cherenkov signal</em>!</p>
<p>Let’s take a look at several traces to see if the peaks area aligned:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">pix_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">269</span><span class="p">,</span><span class="mi">270</span><span class="p">,</span><span class="mi">271</span><span class="p">,</span><span class="mi">272</span><span class="p">,</span><span class="mi">273</span><span class="p">,</span><span class="mi">274</span><span class="p">,</span><span class="mi">275</span><span class="p">,</span><span class="mi">276</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">teldata</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">pix_id</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pix </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pix_id</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x7fedcdeef588&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_29_1.png" src="../_images/tutorials_raw_data_exploration_29_1.png" />
</div>
</div>
</div>
<div class="section" id="Look-at-the-time-trace-from-a-Camera-Pixel">
<h2>Look at the time trace from a Camera Pixel<a class="headerlink" href="#Look-at-the-time-trace-from-a-Camera-Pixel" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ctapipe.calib.camera</span></code> includes classes for doing automatic trace integration with many methods, but before using that, let’s just try to do something simple!</p>
<p>Let’s define the integration windows first: By eye, they seem to be reaonsable from sample 8 to 13 for signal, and 20 to 29 for pedestal (which we define as the sum of all noise: NSB + electronic)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">pix_id</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">269</span><span class="p">,</span><span class="mi">270</span><span class="p">,</span><span class="mi">271</span><span class="p">,</span><span class="mi">272</span><span class="p">,</span><span class="mi">273</span><span class="p">,</span><span class="mi">274</span><span class="p">,</span><span class="mi">275</span><span class="p">,</span><span class="mi">276</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">teldata</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">pix_id</span><span class="p">],</span><span class="s1">&#39;+-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1200</span><span class="p">],</span><span class="mi">20</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ped window&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1200</span><span class="p">],</span><span class="mi">8</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Signal window&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x7fedcde0cd68&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_32_1.png" src="../_images/tutorials_raw_data_exploration_32_1.png" />
</div>
</div>
</div>
<div class="section" id="Do-a-very-simplisitic-trace-analysis">
<h2>Do a very simplisitic trace analysis<a class="headerlink" href="#Do-a-very-simplisitic-trace-analysis" title="Permalink to this headline">¶</a></h2>
<p>Now, let’s for example calculate a signal and background in a the fixed windows we defined for this single event. Note we are ignoring the fact that cameras have 2 gains, and just using a single gain (channel 0, which is the high-gain channel):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">teldata</span><span class="o">.</span><span class="n">waveform</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">peds</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">20</span><span class="p">:</span><span class="mi">29</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># mean of samples 20 to 29 for all pixels</span>
<span class="n">sums</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">8</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">13</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span>    <span class="c1"># simple sum integration</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">phist</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">peds</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pedestal Distribution of all pixels for a single event&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Text(0.5, 1.0, &#39;Pedestal Distribution of all pixels for a single event&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_35_1.png" src="../_images/tutorials_raw_data_exploration_35_1.png" />
</div>
</div>
<p>let’s now take a look at the pedestal-subtracted sums and a pedestal-subtracted signal:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sums</span> <span class="o">-</span> <span class="n">peds</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;pixel id&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pedestal-subtracted Signal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Text(0, 0.5, &#39;Pedestal-subtracted Signal&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_37_1.png" src="../_images/tutorials_raw_data_exploration_37_1.png" />
</div>
</div>
<p>Now, we can clearly see that the signal is centered at 0 where there is no Cherenkov light, and we can also clearly see the shower around pixel 250.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># we can also subtract the pedestals from the traces themselves, which would be needed to compare peaks properly</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">270</span><span class="p">,</span><span class="mi">280</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">-</span> <span class="n">peds</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pix</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.legend.Legend at 0x7fedcdfab5f8&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_39_1.png" src="../_images/tutorials_raw_data_exploration_39_1.png" />
</div>
</div>
</div>
<div class="section" id="Camera-Displays">
<h2>Camera Displays<a class="headerlink" href="#Camera-Displays" title="Permalink to this headline">¶</a></h2>
<p>It’s of course much easier to see the signal if we plot it in 2D with correct pixel positions!</p>
<blockquote>
<div><p>note: the instrument data model is not fully implemented, so there is not a good way to load all the camera information (right now it is hacked into the <code class="docutils literal notranslate"><span class="pre">inst</span></code> sub-container that is read from the Monte-Carlo file)</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">camgeom</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">inst</span><span class="o">.</span><span class="n">subarray</span><span class="o">.</span><span class="n">tel</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span><span class="o">.</span><span class="n">camera</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;CT24, run </span><span class="si">{}</span><span class="s2"> event </span><span class="si">{}</span><span class="s2"> ped-sub&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">obs_id</span><span class="p">,</span><span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">event_id</span><span class="p">)</span>
<span class="n">disp</span> <span class="o">=</span> <span class="n">CameraDisplay</span><span class="p">(</span><span class="n">camgeom</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
<span class="n">disp</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">sums</span> <span class="o">-</span> <span class="n">peds</span>
<span class="n">disp</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span>
<span class="n">disp</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">()</span>
<span class="n">disp</span><span class="o">.</span><span class="n">set_limits_percent</span><span class="p">(</span><span class="mi">95</span><span class="p">)</span>  <span class="c1"># autoscale</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_42_0.png" src="../_images/tutorials_raw_data_exploration_42_0.png" />
</div>
</div>
<p>It looks like a nice signal! We have plotted our pedestal-subtracted trace integral, and see the shower clearly!</p>
<p>Let’s look at all telescopes:</p>
<blockquote>
<div><p>note we plot here the raw signal, since we have not calculated the pedestals for each)</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">tel</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">tels_with_data</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">camgeom</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">inst</span><span class="o">.</span><span class="n">subarray</span><span class="o">.</span><span class="n">tel</span><span class="p">[</span><span class="n">tel</span><span class="p">]</span><span class="o">.</span><span class="n">camera</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;CT</span><span class="si">{}</span><span class="s2">, run </span><span class="si">{}</span><span class="s2"> event </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tel</span><span class="p">,</span><span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">obs_id</span><span class="p">,</span><span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">event_id</span><span class="p">)</span>
    <span class="n">disp</span> <span class="o">=</span> <span class="n">CameraDisplay</span><span class="p">(</span><span class="n">camgeom</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">disp</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">r0</span><span class="o">.</span><span class="n">tel</span><span class="p">[</span><span class="n">tel</span><span class="p">]</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">disp</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdBu_r</span>
    <span class="n">disp</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">()</span>
    <span class="n">disp</span><span class="o">.</span><span class="n">set_limits_percent</span><span class="p">(</span><span class="mi">95</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_0.png" src="../_images/tutorials_raw_data_exploration_44_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_1.png" src="../_images/tutorials_raw_data_exploration_44_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_2.png" src="../_images/tutorials_raw_data_exploration_44_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_3.png" src="../_images/tutorials_raw_data_exploration_44_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_4.png" src="../_images/tutorials_raw_data_exploration_44_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_5.png" src="../_images/tutorials_raw_data_exploration_44_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_6.png" src="../_images/tutorials_raw_data_exploration_44_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_7.png" src="../_images/tutorials_raw_data_exploration_44_7.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_44_8.png" src="../_images/tutorials_raw_data_exploration_44_8.png" />
</div>
</div>
</div>
<div class="section" id="some-signal-processing…">
<h2>some signal processing…<a class="headerlink" href="#some-signal-processing…" title="Permalink to this headline">¶</a></h2>
<p>Let’s try to detect the peak using the scipy.signal package: <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/signal.html">http://docs.scipy.org/doc/scipy/reference/signal.html</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pix_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">has_signal</span> <span class="o">=</span> <span class="n">sums</span> <span class="o">&gt;</span> <span class="mi">300</span>

<span class="n">widths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">8</span><span class="p">,])</span> <span class="c1"># peak widths to search for (let&#39;s fix it at 8 samples, about the width of the peak)</span>
<span class="n">peaks</span> <span class="o">=</span> <span class="p">[</span><span class="n">signal</span><span class="o">.</span><span class="n">find_peaks_cwt</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span><span class="n">widths</span><span class="p">)</span> <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">has_signal</span><span class="p">]</span> <span class="p">]</span>

<span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pix_ids</span><span class="p">[</span><span class="n">has_signal</span><span class="p">],</span><span class="n">peaks</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pix</span><span class="si">{}</span><span class="s2"> has peaks at sample </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">s</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;steps-mid&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">data</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="n">s</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pix495 has peaks at sample [ 8 19]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_raw_data_exploration_47_1.png" src="../_images/tutorials_raw_data_exploration_47_1.png" />
</div>
</div>
<p>clearly the signal needs to be filtered first, or an appropriate wavelet used, but the idea is nice</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="calibrated_data_exploration.html" class="btn btn-neutral float-right" title="Explore Calibrated Data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ctapipe_handson.html" class="btn btn-neutral float-left" title="Getting Started with ctapipe" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright ctapipe developers.  Last updated 18 Apr 2019 13:56

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>